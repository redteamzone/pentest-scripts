#!/bin/bash

#################################################################
#   Projeto:        Pentest Scrpts                              #
#   Nome:           Discovery Hosts - SYN Packets               #
#   Descrição:      Discovery na rede com SYN packet            #
#   Autor:          Carine Constantino                          #
#   Data:           05/03/2022                                  #                                      
#   Função:         Utiliza Nmap para envio de 1 pacote TCP     #  
#                   com a flag SYN ativada.                     #
#                                                               #
#################################################################

echo "-----------------------------"
echo "DISCOVERY HOSTS - SYN PACKETS" 
echo "-----------------------------"
echo "INPUT::NET $1 - PORTS $2" |& tee audit.$(date +%Y-%m-%d_%H:%M).log
echo "-----------------------------"
for ip in {1..254}; 
do 
	nmap -Pn -sS --open -p $2 --max-retries=1 $1.$ip > log.txt
	cat log.txt | cut -d " " -f 1-7 | grep -v "Starting" | grep -v "Host is up" | grep -v "Nmap done" 
done

