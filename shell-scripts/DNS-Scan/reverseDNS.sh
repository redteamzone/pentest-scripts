#!/usr/bin/bash

#################################################################
#   Projeto:        Pentest Scripts                             #
#   Nome:           Reverse DNS                                 #
#   Descrição:      Consulta Registros PTR                      #
#   Autor:          Carine Constantino                          #
#   Data:           05/03/2022                                  #                                      
#   Função:         Script para consultar os registros PTR e    #
#		    identificar hostnames a partir de uma lista #
#		    de endereços IP's.                          #
#                                                               #
#################################################################

## Informe uma sequência e uma rede ##
## Exemplo: ./reverseDNS.sh "1 254" 192.168.1" ##

echo "---------------------------"
echo "REVERSE DNS"
echo "Report - Date: $(date)"
echo "---------------------------"
for ip in $(seq $1);
do 
	host -t ptr $2.$ip >> log.txt
	awk '/\com/{print $5}' log.txt 2> /dev/null
	cat log.txt | cut -d " " -f 5 -s | grep -v "NXDOMAIN" 
	rm log.txt
done
